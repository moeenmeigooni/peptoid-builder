# peptoid-builder
Set of scripts for generating peptoid structures with randomized backbone structures using tleap and STEPs forcefield. Also repairs ring piercings that may result from backbone dihedral randomization. 

The scripts should be used in the following order:

### (1) write_leap_input.py 

Generates a set of tleap input files that, when run, creates initial peptoid conformers in `generate` mode. 
Arguments:
- `mode`
  - `generate` or `solvate`
- `seq`
  - comma-separated sequence of desired peptoid including N- and C-caps, e.g. `NMC,R20,R20,R59,NH2`
  - sequence residue names must follow STEPs forcefield
- `reps`
  - comma-separated sequence of replicates to be created, e.g. `0,1,2,3` or `4,5`

### (2) minimize.py

Minimizes structures generated from the previous step (in vacuum).
Arguments:
- `rep`
  - replicate to minimize, e.g. `0`

### (3) long_bond_checker.py

Checks system for any long bonds (>0.25 nm). Bonds that remain 'long' after minimizing the system typically indicate that the long bond is piercing a ring. This script identifies the long bonds, and outputs the atom indices of the ring(s) being pierced into `long_bonds.csv`. This is used in the next step to alchemically unpierce the ring. 
Arguments:
- `pdb`
  - pdb file of minimized peptoid structure
- `top`
  - topology file (.parm7) corresponding to `pdb`

### (4) unpierce.py

Uses `long_bonds.csv` from previous step to ameliorate identified ring piercings. The idea here is that a ring-pierced molecule is trapped in a very high-energy non-physical state that is locally stable. The bond that pierces the ring cannot relax to equilibrium because of the non-bonded repulsion from the atoms comprising the ring. To allow the bond to exit the ring, we remove the nonbonded interactions between the long-bond atoms and half of the ring atoms. This allows the bond to 'slip' through one side of the ring, unpiercing it, and finally relax to equilibrium. 
Arguments:
- `in`
  - long_bonds.csv file generated by `long_bond_checker.py`.

### (5) orient.tcl

Orient the peptoid molecule's sulfur-sulfur axis to the z axis. Used in modeling of peptoid molecule junctions under STM-BJ-like conditions. 
Arguments:
- `replicate_ids`
  - comma-separated sequence of replicates to be oriented, e.g. `0,1,2,3` or `4,5`

### (6) write_tleap_input.py

We reuse this script, now in `solvate` mode, to generate tleap input files for solvation of the peptoid systems.
Arguments:
- `mode`
  - `generate` or `solvate`
- `seq`
  - comma-separated sequence of desired peptoid including N- and C-caps, e.g. `NMC,R20,R20,R59,NH2`
  - sequence residue names must follow STEPs forcefield
- `reps`
  - comma-separated sequence of replicates to be created, e.g. `0,1,2,3` or `4,5`

### (7) translate.tcl

Translate the system coordinates such that the minimum x,y,z position of the box is 0,0,0 and all coordinates are positive, following OpenMM's pbc style. 
Arguments:
- `replicate_ids`
  - comma-separated sequence of replicates to be oriented, e.g. `0,1,2,3` or `4,5`
 
### (8) mineq.py

Minimizes and equilibrates solvated peptoid systems to prepare them for production runs. 
Arguments:
- `replicate_id`
  - replicate id to be minimized/equilibrated
- `stage`
  - holding stage (6, 9, or 12)
